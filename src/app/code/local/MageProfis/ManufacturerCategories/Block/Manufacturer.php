<?phpclass MageProfis_ManufacturerCategories_Block_Manufacturer extends Mage_Core_Block_Template {    /**     * retrieve current product from registry     * @return Object      */    public function getCurrentProduct() {        return Mage::registry('current_product');    }         /**     * get id of Manufacturers Parent category from config data     * @return string     */    public function getManufacturerParentCategory()    {        return Mage::getStoreConfig('manufacturercategories/general/category');    }        /**     * Get Manufacturer Category for current product by category path     * @return object || false     */    public function getManufacturerCategory()    {        foreach($this->getCurrentProduct()->getCategoryCollection()->getData() as $_category)        {                        $parent = '/' . trim((string)$this->getManufacturerParentCategory()) . '/';            if(strpos($_category['path'], $parent))            {                $id = end(explode('/', trim($_category['path'], '/')));                $category = Mage::getModel('catalog/category')->getCollection()                                            ->addAttributeToSelect('*')                                            ->addIdFilter($id)                                            ->getFirstItem();                return $category;            }        }        return false;    }        /**     * return "" if module is not activated in settings     * @return      */    protected function _toHtml() {        if (!Mage::getStoreConfigFlag('manufacturercategories/product/active')) {            return '';        }        return parent::_toHtml();    }}